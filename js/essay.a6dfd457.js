(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["essay"],{4263:function(e,t,n){"use strict";n.r(t);var i=n("7a23"),o={class:"h-full essay"},a={key:0,id:"toTop",class:"mb-8"},s=Object(i["j"])("div",{class:"h-8"},null,-1);function r(e,t,n,r,c,l){var h=Object(i["y"])("PeekBox"),u=Object(i["z"])("katex");return Object(i["s"])(),Object(i["g"])("div",o,[(Object(i["s"])(),Object(i["g"])(i["b"],{to:"head"},[Object(i["j"])("title",null,Object(i["B"])(e.title),1)])),Object(i["j"])(i["c"],{name:"loadEssay"},{default:Object(i["F"])((function(){return[e.showContent?Object(i["G"])((Object(i["s"])(),Object(i["g"])("div",{key:0,id:"essay-content",innerHTML:e.essayContent},null,8,["innerHTML"])),[[u]]):Object(i["h"])("",!0)]})),_:1}),Object(i["j"])(i["c"],{name:"loadEssay"},{default:Object(i["F"])((function(){return[e.showContent?(Object(i["s"])(),Object(i["g"])("div",a,[Object(i["j"])("button",{title:"Go to top",class:"block w-8 mx-auto text-3xl",onClick:t[1]||(t[1]=function(){return e.scrollToTop&&e.scrollToTop.apply(e,arguments)})},"▲")])):Object(i["h"])("",!0)]})),_:1}),Object(i["j"])(i["c"],{name:"loadSub"},{default:Object(i["F"])((function(){return[e.showSub?(Object(i["s"])(),Object(i["g"])("iframe",{key:0,class:"container w-5/6 p-4 mx-auto mb-8 bg-white border-t border-gray-100 shadow-xl h-72 dark:shadow-3lg-dark sm:h-96 rounded-3xl bg-opacity-80",src:e.iframeSrc,frameborder:"0",scrolling:"no",onLoad:t[2]||(t[2]=function(t){return e.showSub=!0})},null,40,["src"])):Object(i["h"])("",!0)]})),_:1}),s,Object(i["j"])(h,{onOverPeekBox:t[3]||(t[3]=function(t){return e.isInPeekBox=!0}),onLeavePeekBox:t[4]||(t[4]=function(t){e.isInPeekBox=!1,e.handleLeaveRefLink()}),showPeekBox:e.showPeekBox,eventClientX:e.eventClientX,eventClientY:e.eventClientY,isInPeekBox:e.isInPeekBox,boxContent:e.refContent,width:18,height:8},null,8,["showPeekBox","eventClientX","eventClientY","isInPeekBox","boxContent"])])}n("4160"),n("b0c0"),n("d3b7"),n("ac1f"),n("3ca3"),n("466d"),n("5319"),n("1276"),n("159b"),n("ddb0"),n("2b3d");var c=n("d4ec"),l=n("262e"),h=n("2caf"),u=n("9ab4"),f=n("ce1f"),d=n("bc3a"),m=n.n(d),v=n("915d"),b=n("1487"),g=n.n(b),k=window.matchMedia("(max-width: 640px)"),w=function(e){Object(l["a"])(n,e);var t=Object(h["a"])(n);function n(){return Object(c["a"])(this,n),t.apply(this,arguments)}return n}(f["b"]);w=Object(u["a"])([Object(f["a"])({data:function(){return{title:"透明盒子计划·文章",iframeSrc:"",essayContent:"",showContent:!1,showSub:!1,refContent:"",showPeekBox:!1,isInPeekBox:!1,timer:"",eventClientX:0,eventClientY:0}},components:{PeekBox:v["a"]},watch:{$route:function(e,t){this.showContent=!1,this.showSub=!1,"Essays"===e.name&&(this.fetchEssay(e.params.essayName),this.addClickListener(),this.scrollToTop(),this.highlightCode(),this.updateTitle(),this.showSubForm())}},mounted:function(){this.fetchEssay(this.$route.params.essayName),this.addClickListener(),this.scrollToTop(),this.highlightCode(),this.updateTitle(),this.showSubForm()},beforeUnmount:function(){this.removeClickListener()},methods:{showSubForm:function(){var e=this;this.iframeSrc="https://clearbox.substack.com/embed",setTimeout((function(){e.showSub=!0}),800)},addClickListener:function(){var e=this;setTimeout((function(){var t=e.$el.getElementsByTagName("a");t.forEach((function(t){return t.addEventListener("click",e.handleClick)})),t=e.$el.getElementsByClassName("footnote-ref"),t.forEach((function(t){t.addEventListener("mouseenter",e.handleOverRefLink),t.addEventListener("mouseleave",e.handleLeaveRefLink)}))}),600)},removeClickListener:function(){var e=this,t=this.$el.getElementsByTagName("a");t.forEach((function(t){return t.removeEventListener("click",e.handleClick)})),t=this.$el.getElementsByClassName("footnote-ref"),t.forEach((function(t){t.removeEventListener("mouseenter",e.handleOverRefLink),t.removeEventListener("mouseleave",e.handleLeaveRefLink)}))},highlightCode:function(){var e=this;g.a.configure({tabReplace:"  ",languages:["javascript","python","ruby","swift","c"]}),setTimeout((function(){e.$el.getElementsByTagName("code").forEach((function(e){g.a.highlightBlock(e)}))}),600)},scrollToTop:function(){setTimeout((function(){var e;null===(e=document.getElementById("app"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start"})}),100)},updateTitle:function(){var e=this;setTimeout((function(){var t=e.$el.getElementsByClassName("note-title")[0];e.title=t?"透明盒子计划「".concat(t.innerText,"」"):"透明盒子计划·文章"}),600)},handleOverRefLink:function(e){var t=this;k.matches||(this.timer=setTimeout((function(){t.eventClientX=e.clientX,t.eventClientY=e.clientY;var n=e.target.getElementsByTagName("a")[0],i=n.getAttribute("href").split("#")[1],o=document.getElementById(i);o&&(t.refContent=o.innerHTML.replace("↩",""),t.showPeekBox=!0)}),1e3))},handleLeaveRefLink:function(e){var t=this;k.matches||(clearTimeout(this.timer),setTimeout((function(){t.isInPeekBox||(t.showPeekBox=!1)}),200))},fetchEssay:function(e){var t=this;m.a.get("/notes/essays/".concat(e)).then((function(e){t.essayContent=e.data,t.showContent=!0})).catch((function(e){console.log(e)}))},scrollToElement:function(e){e&&(e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),e.classList.add("highlight"),setTimeout((function(){e.classList.remove("highlight")}),5e3))},handleClick:function(e){var t=e.target,n=t.getAttribute("href");if(n.match(/^#fn-\d+$/)||n.match(/^#fnref-\d+$/)){e.preventDefault();var i=document.getElementById(n.split("#")[1]);this.scrollToElement(i)}else{var o=this.filterClickEvent(e);o&&(e.preventDefault(),this.removeClickListener(),this.showSub=!1,this.showContent=!1,this.$router.push({path:o}))}},filterClickEvent:function(e){var t=e.target;while(t&&"A"!==t.tagName)t=t.parentNode;if(t&&t.matches("#essay-content a:not([href*='://'])")&&t.href){var n=e.altKey,i=e.ctrlKey,o=e.metaKey,a=e.shiftKey,s=e.button;e.defaultPrevented;if(o||n||i||a)return!1;if(void 0!==s&&0!==s)return!1;if(t&&t.getAttribute){var r=t.getAttribute("target");if(/\b_blank\b/i.test(r))return!1}var c=new URL(t.href),l=c.pathname.split("/")[1];return!!e.preventDefault&&l}}}})],w);var p=w;p.render=r;t["default"]=p},"466d":function(e,t,n){"use strict";var i=n("d784"),o=n("825a"),a=n("50c4"),s=n("1d80"),r=n("8aa5"),c=n("14c3");i("match",1,(function(e,t,n){return[function(t){var n=s(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,n):new RegExp(t)[e](String(n))},function(e){var i=n(t,e,this);if(i.done)return i.value;var s=o(e),l=String(this);if(!s.global)return c(s,l);var h=s.unicode;s.lastIndex=0;var u,f=[],d=0;while(null!==(u=c(s,l))){var m=String(u[0]);f[d]=m,""===m&&(s.lastIndex=r(l,a(s.lastIndex),h)),d++}return 0===d?null:f}]}))}}]);